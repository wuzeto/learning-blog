<script>
window.MathJax = {
  tex: {
    inlineMath: [['$', '$'], ['\\(', '\\)']],
    displayMath: [['$$', '$$'], ['\\[', '\\]']],
    macros: {
      oiint: "{\\mathchoice{\\mkern-18mu\\iint}{\\mkern-12mu\\iint}{\\mkern-13mu\\iint}{\\mkern-12mu\\iint}}"
    }
  }
};
</script>
<script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>



# 一、网络体系结构与协议



## ISO/OSI参考模型（7层）



**层次结构与功能：**

1. **物理层**：比特传输，机械/电气/功能/规程特性

2. **数据链路层**：帧传输，差错控制，流量控制，MAC寻址

3. **网络层**：分组传输，路由选择，拥塞控制，IP编址

4. **传输层**：端到端通信，可靠传输，流量控制，复用/分用

5. **会话层**：建立/管理/终止会话

6. **表示层**：数据格式转换，加密解密，压缩解压

7. **应用层**：为用户提供网络服务接口



**易错点：**会话层和表示层在实际网络（TCP/IP）中很少单独实现，通常并入应用层



## TCP/IP参考模型（4/5层）



**层次结构：**

| 层次 | 协议示例 | 数据单元 |

|------|----------|----------|

| 应用层 | HTTP, FTP, SMTP, DNS | 报文/消息 |

| 传输层 | TCP, UDP | 段/数据报 |

| 网络层 | IP, ICMP, ARP | 分组/数据报 |

| 网络接口层 | Ethernet, PPP | 帧 |



**与OSI对比：**

* TCP/IP更简洁实用，OSI更理论化

* TCP/IP网络层只提供无连接服务

* TCP/IP在设计时就考虑了异构网络互联



# 二、物理层



## 传输介质与编码



**导向传输介质：**

* **双绞线**：UTP（非屏蔽，常用Cat5e、Cat6）、STP（屏蔽）

* **同轴电缆**：基带同轴（50Ω）、宽带同轴（75Ω）

* **光纤**：

    * 单模光纤：芯径小（8-10μm），传输距离远（可达100km）

    * 多模光纤：芯径大（50-62.5μm），传输距离短（2km以内）



**编码方式：**

| 编码 | 描述 | 优点 | 缺点 |

|------|------|------|------|

| NRZ | 不归零制 | 简单 | 无时钟同步 |

| NRZI | 不归零反转 | 差分编码抗干扰 | 长0序列失同步 |

| 曼彻斯特 | 位中间跳变 | 自同步 | 带宽加倍 |

| 差分曼彻斯特 | 位开始跳变 | 抗干扰强 | 复杂 |



## 性能指标与定理



**重要公式：**

1. **Nyquist定理**：$C = 2B \log_2 M$

    * $C$：无噪声信道极限速率

    * $B$：带宽（Hz）

    * $M$：信号状态数



2. **Shannon定理**：$C = B \log_2(1 + S/N)$

    * $S/N$：信噪比，常用dB表示：$10\log_{10}(S/N)$

    * 实际应用取较小值：$C_{\text{实际}} = \min(C_{\text{Nyquist}}, C_{\text{Shannon}})$



3. **时延计算**：

    * 发送时延：$T_{\text{send}} = L/R$

    * 传播时延：$T_{\text{prop}} = D/V$

    * 处理时延：$T_{\text{proc}}$（通常忽略）

    * 排队时延：$T_{\text{queue}}$（随机）

    * 总时延：$T_{\text{total}} = T_{\text{send}} + T_{\text{prop}} + T_{\text{proc}} + T_{\text{queue}}$



**易错点：**

* 混淆发送时延和传播时延：发送时延与数据长度成正比，传播时延与距离成正比

* 时延带宽积 = 传播时延 × 带宽，表示链路上能容纳的比特数

* 吞吐量 = min(发送速率，链路带宽)，瓶颈在最小带宽处



## 调制与多路复用



**调制技术：**

* **ASK**：幅移键控，抗干扰差

* **FSK**：频移键控，抗干扰中等

* **PSK**：相移键控，抗干扰强

* **QAM**：正交幅度调制，$M=16,64,256$等



**多路复用：**

| 类型 | 原理 | 应用 | 特点 |

|------|------|------|------|

| FDM | 频率分割 | 有线电视，无线电 | 模拟信号 |

| TDM | 时间分割 | 数字电话，SDH | 同步/统计 |

| WDM | 波分复用 | 光纤通信 | 光的FDM |

| CDM | 码分复用 | CDMA移动通信 | 正交码序列 |



# 三、数据链路层



## 差错控制与帧结构



**CRC检错算法：**

1. 设生成多项式位数为n+1，数据后补n个0

2. 用生成多项式对补0后的数据进行模2除法

3. 余数作为校验码



**帧结构对比：**

| 帧类型 | 前导码 | 地址字段 | 类型/长度 | 校验和 |

|--------|--------|----------|-----------|--------|

| 以太网帧 | 7B前导码+1B帧首定界符 | 6B目的+6B源 | 2B类型/长度 | 4B CRC |

| PPP帧 | 1B标志(0x7E) | 1B地址(0xFF) | 1B控制(0x03) | 2B协议+2B CRC |



## MAC协议



**信道划分协议：**

* **TDMA**：固定时隙，无冲突但效率低

* **FDMA**：固定频段，无冲突但频谱利用率低

* **CDMA**：所有用户同时同频通信，码字正交



**随机访问协议：**

1. **ALOHA**：

    * 纯ALOHA：$S = Ge^{-2G}$，最大吞吐量18.4%

    * 时隙ALOHA：$S = Ge^{-G}$，最大吞吐量36.8%



2. **CSMA**：

    * 1-坚持CSMA：信道忙则持续监听

    * 非坚持CSMA：信道忙则随机等待

    * p-坚持CSMA：以概率p发送



3. **CSMA/CD（以太网）**：

    * 监听信道，空闲则发送

    * 边发送边检测冲突

    * 若检测到冲突，发送阻塞信号并停止发送

    * 执行二进制指数退避算法：第i次重传，随机等待$r \times 512$比特时间，$r \in [0, 2^{\min(i,10)}-1]$

    * 重传16次失败则报告错误



4. **CSMA/CA（无线）**：

    * 使用RTS/CTS握手

    * 三种帧间间隔：SIFS < PIFS < DIFS

    * 虚拟载波监听：NAV计数器



**重难点：**

* **最小帧长**：$L_{\min} = 2\tau \times R$，确保发送期间能检测冲突

* **争用期**：$2\tau$，即端到端往返时延

* 二进制指数退避：第$i$次重传，$r \in [0, 2^{\min(i,10)}-1]$

* CSMA/CD用于有线，CSMA/CA用于无线（隐蔽站问题）



## 局域网与交换机



**IEEE 802标准：**

| 标准 | 名称 | 速率 | 介质 |

|------|------|------|------|

| 802.3 | 以太网 | 10M/100M/1G/10G | 双绞线/光纤 |

| 802.11 | WiFi | 11M/54M/... | 无线 |

| 802.15 | 蓝牙 | 1M/2M/... | 无线 |



**网络设备对比：**

| 设备 | 工作层次 | 功能 | 冲突域 | 广播域 |

|------|----------|------|--------|--------|

| 集线器Hub | 物理层 | 信号放大转发 | 共享 | 共享 |

| 网桥Bridge | 数据链路层 | 帧过滤转发 | 分隔 | 共享 |

| 交换机Switch | 数据链路层 | 基于MAC转发 | 每个端口独立 | 共享 |

| 路由器Router | 网络层 | 路由选择 | 每个端口独立 | 分隔 |



**VLAN技术：**

* **端口VLAN**：基于交换机端口划分

* **MAC VLAN**：基于MAC地址划分

* **协议VLAN**：基于协议类型划分

* **802.1Q标签**：4字节，包含VLAN ID（12位）